{{- if .Values.secrets.useSealed }}
---
# SealedSecret for OpenAI API Key
#
# To create this secret:
# 1. Create a regular secret YAML:
#    echo -n 'sk-your-openai-api-key' | kubectl create secret generic resume-secrets \
#      --dry-run=client --from-file=openai-api-key=/dev/stdin -o yaml > secret.yaml
#
# 2. Seal it with kubeseal:
#    kubeseal --format=yaml --cert=pub-cert.pem < secret.yaml > chart/templates/sealedsecret.yaml
#
# 3. Delete the unencrypted secret file:
#    rm secret.yaml
#
# 4. Commit the SealedSecret to Git
#
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: {{ .Values.secrets.existingSecret }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "resume.labels" . | nindent 4 }}
spec:
  encryptedData:
    # This is an EXAMPLE - replace with your actual sealed secret
    # Generated with: kubeseal --raw --from-file=openai-api-key --namespace=resume --name=resume-secrets
    openai-api-key: AgA...encrypted-base64-data-here...==
  template:
    metadata:
      name: {{ .Values.secrets.existingSecret }}
      namespace: {{ .Release.Namespace }}
      labels:
        {{- include "resume.labels" . | nindent 8 }}
    type: Opaque
{{- end }}
